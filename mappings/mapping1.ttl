@prefix c2t: <https://w3id.org/c2t#> .
@prefix c2ti: <https://w3id.org/c2t/i/> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix dpv: <http://dockerpedia.inf.utfsm.cl/vocab#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> . 
@prefix : <http://example.org/> .


:ls a rml:LogicalSource ;
  rml:source "./mini_result.json";
  rml:referenceFormulation ql:JSONPath ;
  rml:iterator "$" .



<Image_Layer_Mapping> 
    rml:logicalSource :ls;

    rml:subjectMap [
        rr:template "https://w3id.org/c2t/i/Layer/{components.layersId}";
        rr:class dpv:ImageLayer ;
        rr:termType rr:IRI
    ].


<Image_Mapping> 
    rml:logicalSource :ls;

    rml:subjectMap [
        rr:template "https://w3id.org/c2t/i/Image/{image_identifier}" ;
        rr:class dpv:Image ;
        rr:termType rr:IRI
].
 

<PackageVersion_Mapping> 
    rml:logicalSource :ls;

    rml:subjectMap [
    rr:template "https://w3id.org/c2t/i/PackageURL/{components.purl}";
    rr:class c2t:PackageVersion;
    rr:termType rr:IRI
    ];


    rr:predicateObjectMap [
        rr:predicate dpv:IsInstalledOn;
        rml:objectMap [ 
            rr:parentTriplesMap <Image_Mapping>;
            rr:joinCondition [
                rr:child "image_identifier";  rr:parent "image_identifier";];
    ]
    ];

    rr:predicateObjectMap [
        rr:predicate dpv:IsInstalledOnLayer;
        rml:objectMap [ 
            rr:parentTriplesMap <Image_Layer_Mapping>;
            rr:joinCondition [
                rr:child "components.layersId";  rr:parent "components.layersId";];
    ]
].





